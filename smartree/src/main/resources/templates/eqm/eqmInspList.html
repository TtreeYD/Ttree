<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>설비점검조회</title>
</head>
<body>
	<div layout:fragment="content">
	<h2>설비점검조회</h2>
	
	<div> 
		
    <input type="radio" id="all" name="inspJudg" value="" checked />
    <label for="all">전체</label>
 
 	<input type="radio" id="y" name="inspJudg" value="y" />
    <label for="y">적합</label>
    
    <input type="radio" id="n" name="inspJudg" value="n"/>
    <label for="n">부적합</label>
	</div>
	
	<div style="padding-bottom: 10px;">
	<label>설비명  :  </label>
	<input type= "text">
	<button type="button" id="searchBtn" class="btn btn-primary">검색</button>
	</div>
	
	<div id="grid"></div>
	
	    <script>
        var grid;
        window.onload=function(){
   	
    const grid = new tui.Grid({
      el: document.getElementById('grid'),
      scrollX: false,
      scrollY: false,
      rowHeaders:["rowNum"],
      columns: [
        {
          header: '설비코드',
          name: 'eqmCode'
        },
        {
          header: '설비명',
          name: 'eqmName'
        },
        {
            header: '담당자',
            name: 'inptManager'
        },
        {
              header: '판정',
              name: 'inspJudg'
        },
        {
            header: '수리일시',
            name: 'repairDate'
        },
        {
            header: '최근점검일시',
            name: 'recentInspDate'
        },
        {
            header: '차기점검일시',
            name: 'nextInspDate'
      },
      {
          header: '점검내역',
          name: 'inspDt'
 	   },
 	   {
        header: '조치내용',
        name: 'actionDt'
  }
      ]
    });
    getEqmInspList();

	
	$('#all').on('click',function(){
		
		getEqmInspList();
	})
	
	$('#y').on('click',function(){
		let judg= $('#y').val();
		getEqmInspJudgList(judg);
	})
	$('#n').on('click',function(){
		let judg= $('#n').val();
		getEqmInspJudgList(judg);
	})
	
    function getEqmInspList(){
    	$.ajax({
    		url:'/eqmInsps',
    		method:'get',
        dataType:'json',
    		success:function(result){
    			console.log(result);
    			grid.resetData(eval(result));
    		},
    		error:function(err){
    			console.log(err);
    		}
    	})
    }

	
	function getEqmInspJudgList(inspJudg){
		$.ajax({
			url:'/eqmInspJudg',
			data: {inspJudg:inspJudg},
			success: result=>{
				//console.log(eqmUcheck)
				//console.log(result)
				 grid.resetData(eval(result));
			},
			error: err => console.log(err)
		})
	}
	
    
  }
          
    </script>
	</div>
</body>
</html>
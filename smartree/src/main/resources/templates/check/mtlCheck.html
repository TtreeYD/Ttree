<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <meta charset="UTF-8">
    <title>SMARTREE</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/tui-grid@4.21.16/dist/tui-grid.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.css" /> 
		<script src="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.js"></script>
		<script src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/tui-grid@4.21.16/dist/tui-grid.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
</head> 
<style>
/* The Modal (background) */
.modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4); /* 검은색 반투명 배경 */
}

/* Modal Content/Box */
.modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 30%;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
    text-align: center;
}

/* Close Button */
.close {
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
}
</style>

<body>
	<div layout:fragment="content">
		<div class="btn-group btn-right" role="group" aria-label="Basic example" style="float: right; padding-bottom: 10px;" >
			<button type="reset" id="resetBtn" class="btn btn-primary">초기화</button>
			<button type="button" id="searchBtn" class="btn btn-primary">검색</button>
			<button type="submit" id="addBtn" class="btn btn-primary">저장</button>
			
		  </div>
	<div id="grid1"></div>
    <div id="grid2"></div>
    
     <div id="myModal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <p style="text-align: center;"><span style="font-size: 14pt;"><b><span style="font-size: 24pt;">
		발주일자 <input type="text">
		거래처 <input type="text">
		</span></b></span></p>
        <p style="text-align: center; line-height: 1.5;"><br />
			
		</p>
        <p><br /></p>
        <div style="cursor:pointer;background-color:#DDDDDD;text-align: center;padding-bottom: 10px;padding-top: 10px;" onClick="closeModal();">
            <span class="pop_bt" style="font-size: 13pt;">닫기</span>
        </div>
    </div>
</div>

    
    <script>
        var grid;
      	var grid2;
        window.onload=function(){
	        const grid = new tui.Grid({
	        	      el: document.getElementById('grid1'),
	        	      scrollX: false,
	        	      scrollY: false,
	        	      rowHeaders:["rowNum"],
	        	      columns: [
	        	        {
	        	          header: '발주일자',
	        	          name: ''
	        	        },
	        	        {
	        	          header: '거래처',
	        	          name: ''
	        	        }
					]
	        	    });
				
		    const grid2 = new tui.Grid({
			      el: document.getElementById('grid2'),
			      scrollX: false,
			      scrollY: false,
			      rowHeaders:["rowNum"],
			      columns: [
			        {
			          header: '자재명',
			          name: ''
			        },
			        {
			          header: '자재코드',
			          name: ''
			        },
			        {
			          header: '검사량',
			          name: 'mtlChkCnt'
			        },
			        {
			           header: '불량량',
			           name: 'mtlErrorCnt'
			        },
			        {
			           header: '합격량',
			           name: 'mtlPassCnt'
			         }, 
			         {
			            header: '검사자',
			            name: 'mtlChkManager'
			          },
			      ]
			    });
		    const header = ['mtlDate', 'bpCode']
			
		    function getDate(sec) {
		        let date = new Date(sec);
		        let year = date.getFullYear();
		        let month = ('0' + (date.getMonth() + 1)).slice(-2);
		        let day = ('0' + date.getDate()).slice(-2);

		        return year + '-' + month + '-' + day;
		    }
		    
				$.ajax({
					url:'/check',
					method:'get',
			    dataType:'json',
					success:function(result){
						//날짜변환
			            $(result).each(function (idx, obj) {
			              for (let head of header) {

			                if (head.slice(-4).toLowerCase() == 'date') {
			                  obj[head] = getDate(obj[head]);
			                }
			              }
			            });

						grid.resetData(eval(result));
						grid2.resetData(eval(result));
					},
					error:function(err){
						console.log(err);
					}
				})
			    
			  }
			    
			  $('#searchBtn').on('click',function(e){
				  openModal();
			});
			  function openModal() {
				    document.getElementById('myModal').style.display = 'block';
				}

				function closeModal() {
				    document.getElementById('myModal').style.display = 'none';
				}
			
			
		
    </script>

	</div>
</body>
</html>